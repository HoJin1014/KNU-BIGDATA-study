{"title":"Bike Sharing Demand","markdown":{"yaml":{"title":"Bike Sharing Demand","author":"HO JIN","editor":"visual"},"headingText":"train/test file","containsRefs":false,"markdown":"\n\n\n```{r}\ndf <- read.csv(\"../train.csv\", header = T)\ndf1 <- read.csv(\"../test.csv\", header = T)\nstr(df)\nstr(df1)\n```\n\n## train, test 데이터 합치기\n\n```{r}\nlibrary(dplyr)\nalldf <- bind_rows(df, df1)\nstr(alldf)\nsummary(alldf)\n```\n\n## na 값 확인\n\n```{r}\nfor (i in 1:length(alldf)){\n    cat(colnames(alldf)[i],sum(is.na(alldf[,i])),'\\n')\n}\n```\n\n## na 값 0으로 변경 및 변경 확인\n\n```{r}\nalldf[is.na(alldf)] <- 0\n\nfor (i in 1:length(alldf)){\n    cat(colnames(alldf)[i],sum(is.na(alldf[,i])),'\\n')\n}\n```\n\n## 일원분산분석\n\n##### 계절이나 날씨 (독립변수, 범주형 변수)가 count 자전거 대여량(종속변수, 수치형 변수)에 미치는 영향 (집단 간 차이)를 알고 싶어서 일원분산분석을 실시. 그러나 분산 분석을 사용하기 위해서는 정규성과 등분산성이 가정이 되야함. 그러나 자전거 데이터는 정규성 표본 크기가 커서 정규성 가정에 크게 제한을 받지 않아서 생략.\n\n##### bartlett 검정 - 집단 간 분산의 동일성 여부 확인\n\n```{r}\nlibrary(car)\nbartlett.test(count ~ season, data = alldf)\nbartlett.test(count ~ weather, data = alldf)\nbartlett.test(count ~ holiday, data = alldf)\nbartlett.test(count ~ workingday, data = alldf)\n```\n\n##### 그 결과 season과 weather, workingday는 p값이 0.05보다 작기에 집단 간 분산이 같다는 귀무가설을 기각하고 등분산성을 충족하지 못했기에 oneway.test 함수를 사용함. 그리고 holiday는 등분산성 가정이 됐기에 aov 가정이 성립.\n\n```{r}\noneway.test(count ~ season, data = alldf)\noneway.test(count ~ weather, data = alldf)\noneway.test(count ~ workingday, data = alldf)\n```\n\n```{r}\nho <- aov(count ~ holiday, data = alldf,)\nsummary(ho)\n```\n\n```{r fig.height=10, fig.width=10}\nlibrary(gplots)\npar(mfrow=c(3,1))\nplotmeans(count~season ,data = alldf,\n          barcol='tomato', barwidth=3, col='cornflowerblue', lwd=2,\n          main='count & season')\nplotmeans(count~weather ,data = alldf,\n          barcol='tomato', barwidth=3, col='cornflowerblue', lwd=2,\n          main='count & weather')\nplotmeans(count~holiday ,data = alldf,\n          barcol='tomato', barwidth=3, col='cornflowerblue', lwd=2,\n          main='count & holiday')\npar(mfrow = c(1,1))\n```\n\n```{r fig.height=10, fig.width=10}\npar(mfrow=c(3,1))\nboxplot(count~season ,data = alldf, col = 'tomato',\n        main ='count & season')\nboxplot(count~weather ,data = alldf, col = 'tomato',\n        main ='count & weather')\nboxplot(count~holiday ,data = alldf, col = 'tomato',\n        main ='count & holiday')\npar(mfrow = c(1,1))\n```\n\n## 상관분석\n\n```{r}\nlibrary(psych)\npairs.panels(alldf)\n```\n\n### 다중회귀분석\n\n```{r}\nalldf <- alldf[, -1]\nsummary(alldf)\n```\n\n##### count와 나머지 변수\n\n```{r}\nmodel1 <- lm(count ~ . , data = alldf)\nsummary(model1)\n```\n\n##### count 와 temp\n\n```{r}\nmodel2 <- lm(count ~ temp + atemp, data = alldf)\nsummary(model2)\n```\n\n##### count 와 humidity\n\n```{r}\nmodel3 <- lm(count ~ humidity + windspeed, data = alldf)\nsummary(model3)\n```\n\n##### count 와 humidity, temp\n\n```{r}\nmodel4 <- lm(count ~ humidity + temp, data = alldf)\nsummary(model4)\n```\n\n##### count 와 atemp, windspeed\n\n```{r}\nmodel5 <- lm(count ~ atemp + windspeed, data = alldf)\nsummary(model5)\n```\n\n### 후진선택법\n\n```{r}\nmod.selected <- step(model1, direction = \"backward\")\nsummary(mod.selected)\n```\n\n## 결론\n\n#### 일원분산분석 결과\n\n##### season 에서는 봄에 자전거 대여량 개수가 저조했기에 자전거 대여비를 할인해준다던지, 쿠폰제 같은 프로모션을 통해 봄의 대여량을 증가\n\n##### weather 에서는 4번 매우 좋지않음의 수 가 다른 날씨에 비해 매우 적어서 그런지 차이가 컸습니다. 따라서 4번을 배제시켜도 다른 날씨에 조금 더 개선\n\n##### holiday 에서는 쉬는 날 자전거 대여량이 평일에 비해 저조하기에 휴일에 조금 더 자전거를 이용할 수 있게 휴일 이벤트 필요\n\n#### 다중회기분석 결과\n\n##### 풍속과 기온이 대여에 영향을 받은 것으로 보여지기에 사람들이 자전거를 타기 좋은 날씨는 풍속과 기온이 내려갈 수록 자전거 대여가 많아지는 것을 알 수 있었고 따라서대여 어플에 조금 더 정확한 풍속과 기온을 보여주면 좋을 것 같습니다.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"bikesharingdemand.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","theme":"cosmo","title":"Bike Sharing Demand","author":"HO JIN","editor":"visual"},"extensions":{"book":{"multiFile":true}}}}}