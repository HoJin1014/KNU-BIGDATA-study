{
  "hash": "4337da6801f1dc011f5339ff139e9b10",
  "result": {
    "markdown": "---\ntitle: \"Bike Sharing Demand\"\nauthor: \"HO JIN\"\neditor: visual\n---\n\n\n## train/test file\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"../train.csv\", header = T)\ndf1 <- read.csv(\"../test.csv\", header = T)\nstr(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t10886 obs. of  12 variables:\n $ datetime  : chr  \"2011-01-01 00:00:00\" \"2011-01-01 01:00:00\" \"2011-01-01 02:00:00\" \"2011-01-01 03:00:00\" ...\n $ season    : int  1 1 1 1 1 1 1 1 1 1 ...\n $ holiday   : int  0 0 0 0 0 0 0 0 0 0 ...\n $ workingday: int  0 0 0 0 0 0 0 0 0 0 ...\n $ weather   : int  1 1 1 1 1 2 1 1 1 1 ...\n $ temp      : num  9.84 9.02 9.02 9.84 9.84 ...\n $ atemp     : num  14.4 13.6 13.6 14.4 14.4 ...\n $ humidity  : int  81 80 80 75 75 75 80 86 75 76 ...\n $ windspeed : num  0 0 0 0 0 ...\n $ casual    : int  3 8 5 3 0 0 2 1 1 8 ...\n $ registered: int  13 32 27 10 1 1 0 2 7 6 ...\n $ count     : int  16 40 32 13 1 1 2 3 8 14 ...\n```\n:::\n\n```{.r .cell-code}\nstr(df1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t6493 obs. of  9 variables:\n $ datetime  : chr  \"2011-01-20 00:00:00\" \"2011-01-20 01:00:00\" \"2011-01-20 02:00:00\" \"2011-01-20 03:00:00\" ...\n $ season    : int  1 1 1 1 1 1 1 1 1 1 ...\n $ holiday   : int  0 0 0 0 0 0 0 0 0 0 ...\n $ workingday: int  1 1 1 1 1 1 1 1 1 1 ...\n $ weather   : int  1 1 1 1 1 1 1 1 1 2 ...\n $ temp      : num  10.7 10.7 10.7 10.7 10.7 ...\n $ atemp     : num  11.4 13.6 13.6 12.9 12.9 ...\n $ humidity  : int  56 56 56 56 56 60 60 55 55 52 ...\n $ windspeed : num  26 0 0 11 11 ...\n```\n:::\n:::\n\n\n## train, test 데이터 합치기\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nalldf <- bind_rows(df, df1)\nstr(alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t17379 obs. of  12 variables:\n $ datetime  : chr  \"2011-01-01 00:00:00\" \"2011-01-01 01:00:00\" \"2011-01-01 02:00:00\" \"2011-01-01 03:00:00\" ...\n $ season    : int  1 1 1 1 1 1 1 1 1 1 ...\n $ holiday   : int  0 0 0 0 0 0 0 0 0 0 ...\n $ workingday: int  0 0 0 0 0 0 0 0 0 0 ...\n $ weather   : int  1 1 1 1 1 2 1 1 1 1 ...\n $ temp      : num  9.84 9.02 9.02 9.84 9.84 ...\n $ atemp     : num  14.4 13.6 13.6 14.4 14.4 ...\n $ humidity  : int  81 80 80 75 75 75 80 86 75 76 ...\n $ windspeed : num  0 0 0 0 0 ...\n $ casual    : int  3 8 5 3 0 0 2 1 1 8 ...\n $ registered: int  13 32 27 10 1 1 0 2 7 6 ...\n $ count     : int  16 40 32 13 1 1 2 3 8 14 ...\n```\n:::\n\n```{.r .cell-code}\nsummary(alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   datetime             season         holiday          workingday    \n Length:17379       Min.   :1.000   Min.   :0.00000   Min.   :0.0000  \n Class :character   1st Qu.:2.000   1st Qu.:0.00000   1st Qu.:0.0000  \n Mode  :character   Median :3.000   Median :0.00000   Median :1.0000  \n                    Mean   :2.502   Mean   :0.02877   Mean   :0.6827  \n                    3rd Qu.:3.000   3rd Qu.:0.00000   3rd Qu.:1.0000  \n                    Max.   :4.000   Max.   :1.00000   Max.   :1.0000  \n                                                                      \n    weather           temp           atemp          humidity     \n Min.   :1.000   Min.   : 0.82   Min.   : 0.00   Min.   :  0.00  \n 1st Qu.:1.000   1st Qu.:13.94   1st Qu.:16.66   1st Qu.: 48.00  \n Median :1.000   Median :20.50   Median :24.24   Median : 63.00  \n Mean   :1.425   Mean   :20.38   Mean   :23.79   Mean   : 62.72  \n 3rd Qu.:2.000   3rd Qu.:27.06   3rd Qu.:31.06   3rd Qu.: 78.00  \n Max.   :4.000   Max.   :41.00   Max.   :50.00   Max.   :100.00  \n                                                                 \n   windspeed          casual         registered        count      \n Min.   : 0.000   Min.   :  0.00   Min.   :  0.0   Min.   :  1.0  \n 1st Qu.: 7.002   1st Qu.:  4.00   1st Qu.: 36.0   1st Qu.: 42.0  \n Median :12.998   Median : 17.00   Median :118.0   Median :145.0  \n Mean   :12.737   Mean   : 36.02   Mean   :155.6   Mean   :191.6  \n 3rd Qu.:16.998   3rd Qu.: 49.00   3rd Qu.:222.0   3rd Qu.:284.0  \n Max.   :56.997   Max.   :367.00   Max.   :886.0   Max.   :977.0  \n                  NA's   :6493     NA's   :6493    NA's   :6493   \n```\n:::\n:::\n\n\n## na 값 확인\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (i in 1:length(alldf)){\n    cat(colnames(alldf)[i],sum(is.na(alldf[,i])),'\\n')\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndatetime 0 \nseason 0 \nholiday 0 \nworkingday 0 \nweather 0 \ntemp 0 \natemp 0 \nhumidity 0 \nwindspeed 0 \ncasual 6493 \nregistered 6493 \ncount 6493 \n```\n:::\n:::\n\n\n## na 값 0으로 변경 및 변경 확인\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalldf[is.na(alldf)] <- 0\n\nfor (i in 1:length(alldf)){\n    cat(colnames(alldf)[i],sum(is.na(alldf[,i])),'\\n')\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndatetime 0 \nseason 0 \nholiday 0 \nworkingday 0 \nweather 0 \ntemp 0 \natemp 0 \nhumidity 0 \nwindspeed 0 \ncasual 0 \nregistered 0 \ncount 0 \n```\n:::\n:::\n\n\n## 일원분산분석\n\n##### 계절이나 날씨 (독립변수, 범주형 변수)가 count 자전거 대여량(종속변수, 수치형 변수)에 미치는 영향 (집단 간 차이)를 알고 싶어서 일원분산분석을 실시. 그러나 분산 분석을 사용하기 위해서는 정규성과 등분산성이 가정이 되야함. 그러나 자전거 데이터는 정규성 표본 크기가 커서 정규성 가정에 크게 제한을 받지 않아서 생략.\n\n##### bartlett 검정 - 집단 간 분산의 동일성 여부 확인\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ season, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by season\nBartlett's K-squared = 1235.1, df = 3, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ weather, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by weather\nBartlett's K-squared = 335.55, df = 3, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ holiday, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by holiday\nBartlett's K-squared = 3.7999, df = 1, p-value = 0.05126\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~ workingday, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by workingday\nBartlett's K-squared = 16.604, df = 1, p-value = 4.606e-05\n```\n:::\n:::\n\n\n##### 그 결과 season과 weather, workingday는 p값이 0.05보다 작기에 집단 간 분산이 같다는 귀무가설을 기각하고 등분산성을 충족하지 못했기에 oneway.test 함수를 사용함. 그리고 holiday는 등분산성 가정이 됐기에 aov 가정이 성립.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noneway.test(count ~ season, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  count and season\nF = 224.14, num df = 3.0, denom df = 9463.1, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\noneway.test(count ~ weather, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  count and weather\nF = 73.975, num df = 3.0000, denom df = 9.9978, p-value = 3.97e-07\n```\n:::\n\n```{.r .cell-code}\noneway.test(count ~ workingday, data = alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  count and workingday\nF = 0.43713, num df = 1, denom df = 11223, p-value = 0.5085\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nho <- aov(count ~ holiday, data = alldf,)\nsummary(ho)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Df    Sum Sq Mean Sq F value Pr(>F)\nholiday         1      9893    9893   0.339   0.56\nResiduals   17377 506429635   29144               \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gplots)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'gplots'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    lowess\n```\n:::\n\n```{.r .cell-code}\npar(mfrow=c(3,1))\nplotmeans(count~season ,data = alldf,\n          barcol='tomato', barwidth=3, col='cornflowerblue', lwd=2,\n          main='count & season')\nplotmeans(count~weather ,data = alldf,\n          barcol='tomato', barwidth=3, col='cornflowerblue', lwd=2,\n          main='count & weather')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in arrows(x, li, x, pmax(y - gap, li), col = barcol, lwd = lwd, : zero-\nlength arrow is of indeterminate angle and so skipped\n\nWarning in arrows(x, li, x, pmax(y - gap, li), col = barcol, lwd = lwd, : zero-\nlength arrow is of indeterminate angle and so skipped\n\nWarning in arrows(x, li, x, pmax(y - gap, li), col = barcol, lwd = lwd, : zero-\nlength arrow is of indeterminate angle and so skipped\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in arrows(x, ui, x, pmin(y + gap, ui), col = barcol, lwd = lwd, : zero-\nlength arrow is of indeterminate angle and so skipped\n\nWarning in arrows(x, ui, x, pmin(y + gap, ui), col = barcol, lwd = lwd, : zero-\nlength arrow is of indeterminate angle and so skipped\n\nWarning in arrows(x, ui, x, pmin(y + gap, ui), col = barcol, lwd = lwd, : zero-\nlength arrow is of indeterminate angle and so skipped\n```\n:::\n\n```{.r .cell-code}\nplotmeans(count~holiday ,data = alldf,\n          barcol='tomato', barwidth=3, col='cornflowerblue', lwd=2,\n          main='count & holiday')\n```\n\n::: {.cell-output-display}\n![](bikesharingdemand_files/figure-html/unnamed-chunk-8-1.png){width=960}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(3,1))\nboxplot(count~season ,data = alldf, col = 'tomato',\n        main ='count & season')\nboxplot(count~weather ,data = alldf, col = 'tomato',\n        main ='count & weather')\nboxplot(count~holiday ,data = alldf, col = 'tomato',\n        main ='count & holiday')\n```\n\n::: {.cell-output-display}\n![](bikesharingdemand_files/figure-html/unnamed-chunk-9-1.png){width=960}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,1))\n```\n:::\n\n\n## 상관분석\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'psych'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:car':\n\n    logit\n```\n:::\n\n```{.r .cell-code}\npairs.panels(alldf)\n```\n\n::: {.cell-output-display}\n![](bikesharingdemand_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### 다중회귀분석\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalldf <- alldf[, -1]\nsummary(alldf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     season         holiday          workingday        weather     \n Min.   :1.000   Min.   :0.00000   Min.   :0.0000   Min.   :1.000  \n 1st Qu.:2.000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:1.000  \n Median :3.000   Median :0.00000   Median :1.0000   Median :1.000  \n Mean   :2.502   Mean   :0.02877   Mean   :0.6827   Mean   :1.425  \n 3rd Qu.:3.000   3rd Qu.:0.00000   3rd Qu.:1.0000   3rd Qu.:2.000  \n Max.   :4.000   Max.   :1.00000   Max.   :1.0000   Max.   :4.000  \n      temp           atemp          humidity        windspeed     \n Min.   : 0.82   Min.   : 0.00   Min.   :  0.00   Min.   : 0.000  \n 1st Qu.:13.94   1st Qu.:16.66   1st Qu.: 48.00   1st Qu.: 7.002  \n Median :20.50   Median :24.24   Median : 63.00   Median :12.998  \n Mean   :20.38   Mean   :23.79   Mean   : 62.72   Mean   :12.737  \n 3rd Qu.:27.06   3rd Qu.:31.06   3rd Qu.: 78.00   3rd Qu.:16.998  \n Max.   :41.00   Max.   :50.00   Max.   :100.00   Max.   :56.997  \n     casual         registered         count    \n Min.   :  0.00   Min.   :  0.00   Min.   :  0  \n 1st Qu.:  0.00   1st Qu.:  0.00   1st Qu.:  0  \n Median :  3.00   Median : 23.00   Median : 28  \n Mean   : 22.56   Mean   : 97.44   Mean   :120  \n 3rd Qu.: 26.00   3rd Qu.:155.00   3rd Qu.:192  \n Max.   :367.00   Max.   :886.00   Max.   :977  \n```\n:::\n:::\n\n\n##### count와 나머지 변수\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(count ~ . , data = alldf)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ ., data = alldf)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-1.410e-10 -9.500e-14 -2.900e-14  3.800e-14  3.159e-10 \n\nCoefficients:\n              Estimate Std. Error    t value Pr(>|t|)    \n(Intercept)  5.392e-12  1.449e-13  3.721e+01  < 2e-16 ***\nseason      -2.670e-12  2.408e-14 -1.109e+02  < 2e-16 ***\nholiday     -2.202e-12  1.522e-13 -1.447e+01  < 2e-16 ***\nworkingday  -2.939e-12  5.924e-14 -4.961e+01  < 2e-16 ***\nweather     -1.360e-12  4.328e-14 -3.142e+01  < 2e-16 ***\ntemp         1.610e-13  2.058e-14  7.825e+00 5.35e-15 ***\natemp       -4.868e-14  1.896e-14 -2.568e+00  0.01024 *  \nhumidity     4.230e-14  1.562e-15  2.709e+01  < 2e-16 ***\nwindspeed   -1.076e-14  3.277e-15 -3.283e+00  0.00103 ** \ncasual       1.000e+00  8.133e-16  1.229e+15  < 2e-16 ***\nregistered   1.000e+00  2.285e-16  4.377e+15  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.241e-12 on 17368 degrees of freedom\nMultiple R-squared:      1,\tAdjusted R-squared:      1 \nF-statistic: 4.823e+30 on 10 and 17368 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n##### count 와 temp\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- lm(count ~ temp + atemp, data = alldf)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ temp + atemp, data = alldf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-229.50 -115.33  -56.25   69.36  821.35 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   8.9130     3.8943   2.289  0.02211 *  \ntemp          3.7205     1.0157   3.663  0.00025 ***\natemp         1.4828     0.9332   1.589  0.11209    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 165.5 on 17376 degrees of freedom\nMultiple R-squared:  0.06054,\tAdjusted R-squared:  0.06044 \nF-statistic: 559.9 on 2 and 17376 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n##### count 와 humidity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel3 <- lm(count ~ humidity + windspeed, data = alldf)\nsummary(model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ humidity + windspeed, data = alldf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-252.49 -110.53  -58.90   67.42  816.98 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 252.47627    5.38825  46.857   <2e-16 ***\nhumidity     -2.12417    0.06808 -31.203   <2e-16 ***\nwindspeed     0.05950    0.16023   0.371     0.71    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 165.7 on 17376 degrees of freedom\nMultiple R-squared:  0.05804,\tAdjusted R-squared:  0.05793 \nF-statistic: 535.3 on 2 and 17376 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n##### count 와 humidity, temp\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel4 <- lm(count ~ humidity + temp, data = alldf)\nsummary(model4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ humidity + temp, data = alldf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-299.22 -104.75  -43.11   64.62  786.51 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 143.40143    5.39217   26.59   <2e-16 ***\nhumidity     -1.98925    0.06346  -31.35   <2e-16 ***\ntemp          4.97484    0.15507   32.08   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 161 on 17376 degrees of freedom\nMultiple R-squared:  0.1107,\tAdjusted R-squared:  0.1106 \nF-statistic:  1081 on 2 and 17376 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n##### count 와 atemp, windspeed\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel5 <- lm(count ~ atemp + windspeed, data = alldf)\nsummary(model5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ atemp + windspeed, data = alldf)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-263.55 -115.01  -51.78   68.56  833.47 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -21.5548     4.2697  -5.048  4.5e-07 ***\natemp         4.9682     0.1458  34.070  < 2e-16 ***\nwindspeed     1.8346     0.1529  12.001  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 164.9 on 17376 degrees of freedom\nMultiple R-squared:  0.06755,\tAdjusted R-squared:  0.06744 \nF-statistic: 629.4 on 2 and 17376 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### 후진선택법\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod.selected <- step(model1, direction = \"backward\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStart:  AIC=-919522\ncount ~ season + holiday + workingday + weather + temp + atemp + \n    humidity + windspeed + casual + registered\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attempting model selection on an essentially perfect fit is nonsense\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum of Sq       RSS     AIC\n- season      1         0         0 -929634\n- workingday  1         0         0 -922675\n- temp        1         0         0 -922243\n- windspeed   1         0         0 -921132\n- humidity    1         0         0 -920904\n<none>                            0 -919522\n- atemp       1         0         0 -919462\n- holiday     1         0         0 -916585\n- weather     1         0         0 -915576\n- casual      1  15873743  15873743  118495\n- registered  1 201164640 201164640  162629\n\nStep:  AIC=-929633.6\ncount ~ holiday + workingday + weather + temp + atemp + humidity + \n    windspeed + casual + registered\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attempting model selection on an essentially perfect fit is nonsense\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum of Sq       RSS     AIC\n- weather     1         0         0 -949514\n- temp        1         0         0 -940518\n- workingday  1         0         0 -940482\n<none>                            0 -929634\n- windspeed   1         0         0 -925811\n- atemp       1         0         0 -925487\n- holiday     1         0         0 -925392\n- humidity    1         0         0 -924014\n- casual      1  15914806  15914806  118538\n- registered  1 203579221 203579221  162834\n\nStep:  AIC=-949514.1\ncount ~ holiday + workingday + temp + atemp + humidity + windspeed + \n    casual + registered\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attempting model selection on an essentially perfect fit is nonsense\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum of Sq       RSS     AIC\n- holiday     1         0         0 -950898\n- atemp       1         0         0 -950754\n<none>                            0 -949514\n- temp        1         0         0 -929142\n- humidity    1         0         0 -928528\n- workingday  1         0         0 -920527\n- windspeed   1         0         0 -915330\n- casual      1  15968785  15968785  118595\n- registered  1 203656488 203656488  162839\n\nStep:  AIC=-950897.6\ncount ~ workingday + temp + atemp + humidity + windspeed + casual + \n    registered\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attempting model selection on an essentially perfect fit is nonsense\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum of Sq       RSS     AIC\n<none>                            0 -950898\n- workingday  1         0         0 -949528\n- atemp       1         0         0 -948430\n- windspeed   1         0         0 -945234\n- temp        1         0         0 -944214\n- humidity    1         0         0 -930764\n- casual      1  15996057  15996057  118623\n- registered  1 203847705 203847705  162853\n```\n:::\n\n```{.r .cell-code}\nsummary(mod.selected)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ workingday + temp + atemp + humidity + windspeed + \n    casual + registered, data = alldf)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-1.258e-11 -4.900e-14 -1.700e-14  1.400e-14  1.200e-10 \n\nCoefficients:\n              Estimate Std. Error    t value Pr(>|t|)    \n(Intercept)  3.795e-12  5.675e-14  6.689e+01   <2e-16 ***\nworkingday  -1.644e-12  2.321e-14 -7.083e+01   <2e-16 ***\ntemp        -1.422e-13  8.335e-15 -1.706e+01   <2e-16 ***\natemp        1.649e-14  7.673e-15  2.149e+00   0.0316 *  \nhumidity     7.756e-16  5.619e-16  1.380e+00   0.1675    \nwindspeed   -2.687e-15  1.308e-15 -2.054e+00   0.0400 *  \ncasual       1.000e+00  3.286e-16  3.044e+15   <2e-16 ***\nregistered   1.000e+00  9.204e-17  1.087e+16   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.314e-12 on 17371 degrees of freedom\nMultiple R-squared:      1,\tAdjusted R-squared:      1 \nF-statistic: 4.19e+31 on 7 and 17371 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## 결론\n\n#### 일원분산분석 결과\n\n##### season 에서는 봄에 자전거 대여량 개수가 저조했기에 자전거 대여비를 할인해준다던지, 쿠폰제 같은 프로모션을 통해 봄의 대여량을 증가\n\n##### weather 에서는 4번 매우 좋지않음의 수 가 다른 날씨에 비해 매우 적어서 그런지 차이가 컸습니다. 따라서 4번을 배제시켜도 다른 날씨에 조금 더 개선\n\n##### holiday 에서는 쉬는 날 자전거 대여량이 평일에 비해 저조하기에 휴일에 조금 더 자전거를 이용할 수 있게 휴일 이벤트 필요\n\n#### 다중회기분석 결과\n\n##### 풍속과 기온이 대여에 영향을 받은 것으로 보여지기에 사람들이 자전거를 타기 좋은 날씨는 풍속과 기온이 내려갈 수록 자전거 대여가 많아지는 것을 알 수 있었고 따라서대여 어플에 조금 더 정확한 풍속과 기온을 보여주면 좋을 것 같습니다.\n",
    "supporting": [
      "bikesharingdemand_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}